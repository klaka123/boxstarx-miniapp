<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BOXSTARX üöÄ –†–ê–ë–û–ß–ê–Ø –í–ï–†–°–ò–Ø</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
        }

        body {
            background: #0a0c1a;
            color: white;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            padding: 10px;
        }

        #app {
            width: 100%;
            max-width: 450px;
        }

        /* –ë–∞–ª–∞–Ω—Å */
        .balance-card {
            background: linear-gradient(145deg, #1a1f35, #0f1428);
            border-radius: 40px;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            border: 1px solid gold;
            box-shadow: 0 10px 20px rgba(0,0,0,0.5);
        }

        .balance-left {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .star-icon {
            font-size: 24px;
        }

        .balance-amount {
            font-size: 24px;
            font-weight: bold;
            color: gold;
        }

        .add-btn {
            background: #2e7d32;
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 40px;
            font-weight: bold;
            font-size: 16px;
            cursor: pointer;
            border: 1px solid #81c784;
        }

        .add-btn:active {
            transform: scale(0.95);
        }

        /* –†–∞–∫–µ—Ç–∞ */
        .rocket-card {
            background: linear-gradient(145deg, #1a1f35, #0f1428);
            border-radius: 40px;
            padding: 20px;
            margin-bottom: 15px;
            border: 1px solid gold;
        }

        .rocket-display {
            position: relative;
            height: 200px;
            background: #000;
            border-radius: 30px;
            border: 1px solid gold;
            overflow: hidden;
            margin-bottom: 15px;
        }

        /* –ó–≤–µ–∑–¥—ã –≤ –æ–∫–Ω–µ */
        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            filter: blur(1px);
        }

        .rocket {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            font-size: 64px;
            z-index: 10;
            transition: all 0.3s;
        }

        .rocket.explode {
            opacity: 0;
        }

        .explosion {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            font-size: 64px;
            opacity: 0;
            z-index: 20;
        }

        .explosion.show {
            opacity: 1;
        }

        .multiplier-badge {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.8);
            border: 1px solid gold;
            padding: 10px 25px;
            border-radius: 40px;
            font-size: 24px;
            font-weight: bold;
            z-index: 30;
        }

        .multiplier-value {
            color: gold;
            margin-left: 5px;
        }

        .timer {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0,0,0,0.8);
            border: 1px solid gold;
            padding: 8px 20px;
            border-radius: 40px;
            font-size: 18px;
            z-index: 30;
        }

        /* –ö–Ω–æ–ø–∫–∏ –∞–≤—Ç–æ */
        .auto-buttons {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            margin-bottom: 10px;
        }

        .auto-btn {
            background: #1e2638;
            border: 1px solid gold;
            color: white;
            padding: 10px 5px;
            border-radius: 40px;
            font-size: 14px;
            cursor: pointer;
            text-align: center;
        }

        .auto-btn.active {
            background: gold;
            color: black;
            font-weight: bold;
        }

        .auto-btn:active {
            transform: scale(0.95);
        }

        /* –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ */
        .bet-control {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }

        .bet-input {
            flex: 1;
            background: #0f1428;
            border: 1px solid gold;
            color: gold;
            padding: 15px;
            border-radius: 40px;
            font-size: 18px;
            text-align: center;
            outline: none;
        }

        .flight-buttons {
            display: flex;
            gap: 10px;
        }

        .flight-btn {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 40px;
            font-weight: bold;
            font-size: 16px;
            cursor: pointer;
            transition: 0.2s;
        }

        .flight-btn:active {
            transform: scale(0.95);
        }

        .btn-start {
            background: linear-gradient(135deg, #f9d423, #fdaa33);
            color: black;
        }

        .btn-stop {
            background: linear-gradient(135deg, #dc3545, #b02a37);
            color: white;
        }

        .btn-stop:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* –ö–µ–π—Å—ã */
        .section-title {
            font-size: 22px;
            text-align: center;
            margin: 20px 0 15px;
            color: gold;
        }

        .cases-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .case-card {
            background: linear-gradient(145deg, #1a1f35, #0f1428);
            border: 2px solid gold;
            border-radius: 60px;
            padding: 20px 10px;
            text-align: center;
            cursor: pointer;
            transition: 0.2s;
        }

        .case-card:active {
            transform: scale(0.95);
        }

        .case-emoji {
            font-size: 48px;
            margin-bottom: 10px;
        }

        .case-name {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .case-price {
            font-size: 20px;
            color: gold;
            font-weight: bold;
        }

        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            display: none;
            flex-direction: column;
            padding: 20px;
            z-index: 1000;
            overflow-y: auto;
        }

        .modal.active {
            display: flex;
        }

        .modal-header {
            display: flex;
            align-items: center;
            margin-bottom: 30px;
        }

        .modal-back {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #1e2638;
            border: 1px solid gold;
            color: white;
            font-size: 24px;
            cursor: pointer;
            margin-right: 15px;
        }

        .modal-title {
            font-size: 24px;
            font-weight: bold;
            color: gold;
        }

        .quantity-buttons {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            margin: 20px 0;
        }

        .quantity-btn {
            background: #1e2638;
            border: 1px solid gold;
            color: white;
            padding: 15px;
            border-radius: 40px;
            font-size: 18px;
            cursor: pointer;
            text-align: center;
        }

        .quantity-btn.active {
            background: gold;
            color: black;
            font-weight: bold;
        }

        .open-btn {
            width: 100%;
            padding: 20px;
            border: none;
            border-radius: 60px;
            font-size: 24px;
            font-weight: bold;
            background: linear-gradient(135deg, #f9d423, #fdaa33);
            color: black;
            margin: 20px 0;
            cursor: pointer;
        }

        .contents-title {
            font-size: 18px;
            color: gold;
            margin: 20px 0 15px;
        }

        .contents-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .content-item {
            background: #1e2638;
            border: 1px solid gold;
            border-radius: 30px;
            padding: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .content-emoji {
            font-size: 32px;
        }

        .content-name {
            font-size: 14px;
            font-weight: bold;
        }

        .content-price {
            color: gold;
            font-size: 14px;
        }

        /* –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å */
        .inventory-card {
            background: linear-gradient(145deg, #1a1f35, #0f1428);
            border-radius: 40px;
            padding: 20px;
            border: 1px solid gold;
            margin-top: 20px;
        }

        .inventory-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .inventory-title {
            font-size: 20px;
            font-weight: bold;
        }

        .inventory-count {
            background: #1e2638;
            border: 1px solid gold;
            padding: 5px 15px;
            border-radius: 40px;
            font-size: 14px;
        }

        .inventory-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
        }

        .inventory-slot {
            background: #0f1428;
            border: 1px solid gold;
            border-radius: 30px;
            padding: 15px 5px;
            text-align: center;
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        .inventory-slot:active {
            transform: scale(0.95);
        }

        .slot-emoji {
            font-size: 28px;
            margin-bottom: 5px;
        }

        .slot-name {
            font-size: 10px;
            font-weight: bold;
        }

        .slot-price {
            font-size: 10px;
            color: gold;
            margin-top: 3px;
        }

        .empty-slot {
            background: #0f1428;
            border: 1px dashed #555;
            border-radius: 30px;
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #555;
            font-size: 12px;
        }

        /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ */
        .toast {
            position: fixed;
            top: 80px;
            left: 50%;
            transform: translateX(-50%);
            background: #2e7d32;
            color: white;
            padding: 15px 30px;
            border-radius: 60px;
            font-weight: bold;
            z-index: 2000;
            border: 1px solid gold;
            box-shadow: 0 10px 30px black;
        }

        .win-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 3000;
        }

        .win-modal.active {
            display: flex;
        }

        .win-content {
            background: #1a1f35;
            border: 2px solid gold;
            border-radius: 80px;
            padding: 50px 30px;
            text-align: center;
            width: 80%;
            max-width: 350px;
        }

        .win-emoji {
            font-size: 80px;
            margin-bottom: 20px;
        }

        .win-title {
            font-size: 40px;
            font-weight: bold;
            color: gold;
            margin-bottom: 20px;
        }

        .win-amount {
            font-size: 36px;
            color: gold;
            margin-bottom: 30px;
        }

        .win-btn {
            background: linear-gradient(135deg, #f9d423, #fdaa33);
            border: none;
            padding: 15px 40px;
            border-radius: 60px;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div id="app">
        <!-- –ë–∞–ª–∞–Ω—Å -->
        <div class="balance-card">
            <div class="balance-left">
                <span class="star-icon">‚≠ê</span>
                <span class="balance-amount" id="balance">5000</span>
            </div>
            <button class="add-btn" id="addFunds">+100</button>
        </div>

        <!-- –†–∞–∫–µ—Ç–∞ -->
        <div class="rocket-card">
            <div class="rocket-display" id="rocketDisplay">
                <div class="rocket" id="rocket">üöÄ</div>
                <div class="explosion" id="explosion">üí•</div>
                <div class="multiplier-badge">
                    <span>üí∞ </span>
                    <span class="multiplier-value" id="multiplier">1.00x</span>
                </div>
                <div class="timer" id="timer">5—Å</div>
            </div>

            <div class="auto-buttons" id="autoButtons">
                <div class="auto-btn" data-mult="1.1">1.1x</div>
                <div class="auto-btn" data-mult="1.2">1.2x</div>
                <div class="auto-btn" data-mult="1.3">1.3x</div>
                <div class="auto-btn" data-mult="1.5">1.5x</div>
                <div class="auto-btn" data-mult="2.0">2.0x</div>
            </div>

            <div class="bet-control">
                <input type="number" class="bet-input" id="bet" value="100" min="10" step="10">
            </div>

            <div class="flight-buttons">
                <button class="flight-btn btn-start" id="startBtn">üöÄ –°–¢–ê–†–¢</button>
                <button class="flight-btn btn-stop" id="stopBtn" disabled>‚èπÔ∏è –°–¢–û–ü</button>
            </div>
        </div>

        <!-- –ö–µ–π—Å—ã -->
        <h2 class="section-title">üì¶ –ö–û–°–ú–ò–ß–ï–°–ö–ò–ï –ö–ï–ô–°–´</h2>
        <div class="cases-grid" id="casesGrid"></div>

        <!-- –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å -->
        <div class="inventory-card">
            <div class="inventory-header">
                <span class="inventory-title">üì¶ –ò–ù–í–ï–ù–¢–ê–†–¨</span>
                <span class="inventory-count" id="inventoryCount">0/20</span>
            </div>
            <div class="inventory-grid" id="inventoryGrid"></div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∫–µ–π—Å–∞ -->
    <div class="modal" id="caseModal">
        <div class="modal-header">
            <button class="modal-back" id="closeModal">‚Üê</button>
            <div class="modal-title" id="modalTitle">–ö–µ–π—Å</div>
        </div>

        <div class="quantity-buttons" id="quantityButtons">
            <div class="quantity-btn" data-qty="1">1</div>
            <div class="quantity-btn" data-qty="2">2</div>
            <div class="quantity-btn" data-qty="3">3</div>
            <div class="quantity-btn" data-qty="4">4</div>
            <div class="quantity-btn" data-qty="5">5</div>
        </div>

        <button class="open-btn" id="openCaseBtn">–û–¢–ö–†–´–¢–¨ –ó–ê 0 ‚≠ê</button>

        <div class="contents-title">–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–µ–π—Å–∞</div>
        <div class="contents-grid" id="modalContents"></div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–∏–≥—Ä—ã—à–∞ -->
    <div class="win-modal" id="winModal">
        <div class="win-content">
            <div class="win-emoji">üéâ</div>
            <div class="win-title">–ü–û–ë–ï–î–ê!</div>
            <div class="win-amount" id="winAmount">0 ‚≠ê</div>
            <button class="win-btn" id="closeWin">–û–ö</button>
        </div>
    </div>

    <script>
        // –ü—Ä–æ—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ
        const GIFTS = [
            { emoji: "üß∏", name: "–ú–∏—à–∫–∞", price: 15 },
            { emoji: "üéà", name: "–®–∞—Ä", price: 20 },
            { emoji: "üç¨", name: "–ö–æ–Ω—Ñ–µ—Ç–∞", price: 25 },
            { emoji: "üé®", name: "–ö—Ä–∞—Å–∫–∏", price: 30 },
            { emoji: "üìø", name: "–ë—É—Å—ã", price: 35 },
            { emoji: "üß¶", name: "–ù–æ—Å–∫–∏", price: 40 },
            { emoji: "üß¢", name: "–ö–µ–ø–∫–∞", price: 45 },
            { emoji: "‚åö", name: "–ß–∞—Å—ã", price: 150 },
            { emoji: "üíç", name: "–ö–æ–ª—å—Ü–æ", price: 200 },
            { emoji: "üì±", name: "–¢–µ–ª–µ—Ñ–æ–Ω", price: 300 },
            { emoji: "üíé", name: "–ê–ª–º–∞–∑", price: 1000 },
            { emoji: "üëë", name: "–ö–æ—Ä–æ–Ω–∞", price: 1500 }
        ];

        const CASES = [
            { name: "–ë–∞–∑–æ–≤—ã–π", emoji: "üì¶", price: 25, color: "#4a90e2" },
            { name: "–°–µ—Ä–µ–±—Ä–æ", emoji: "ü•à", price: 50, color: "#a0a0a0" },
            { name: "–ó–æ–ª–æ—Ç–æ", emoji: "ü•á", price: 100, color: "#ffd700" },
            { name: "–ü–ª–∞—Ç–∏–Ω–∞", emoji: "üíé", price: 500, color: "#e5e4e2" },
            { name: "–ê–ª–º–∞–∑", emoji: "üí†", price: 1000, color: "#b9f2ff" },
            { name: "–õ–µ–≥–µ–Ω–¥–∞", emoji: "üëë", price: 5000, color: "#ff6b6b" }
        ];

        // –°–æ—Å—Ç–æ—è–Ω–∏–µ
        let balance = 5000;
        let inventory = [];
        let currentCase = null;
        let isFlying = false;
        let multiplier = 1;
        let intervalId = null;
        let countdownId = null;
        let selectedAuto = 1.2;
        let selectedQty = 1;

        // –≠–ª–µ–º–µ–Ω—Ç—ã
        const balanceEl = document.getElementById('balance');
        const addBtn = document.getElementById('addFunds');
        const startBtn = document.getElementById('startBtn');
        const stopBtn = document.getElementById('stopBtn');
        const betInput = document.getElementById('bet');
        const multiplierEl = document.getElementById('multiplier');
        const timerEl = document.getElementById('timer');
        const rocket = document.getElementById('rocket');
        const explosion = document.getElementById('explosion');
        const casesGrid = document.getElementById('casesGrid');
        const inventoryGrid = document.getElementById('inventoryGrid');
        const inventoryCount = document.getElementById('inventoryCount');
        const caseModal = document.getElementById('caseModal');
        const closeModal = document.getElementById('closeModal');
        const modalTitle = document.getElementById('modalTitle');
        const openCaseBtn = document.getElementById('openCaseBtn');
        const modalContents = document.getElementById('modalContents');
        const winModal = document.getElementById('winModal');
        const winAmount = document.getElementById('winAmount');
        const closeWin = document.getElementById('closeWin');

        // –ó–≤–µ–∑–¥—ã –≤ –æ–∫–Ω–µ —Ä–∞–∫–µ—Ç—ã
        function createStars() {
            const display = document.getElementById('rocketDisplay');
            for (let i = 0; i < 30; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.width = Math.random() * 3 + 1 + 'px';
                star.style.height = star.style.width;
                star.style.opacity = Math.random() * 0.8 + 0.2;
                display.appendChild(star);
            }
        }
        createStars();

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
        function saveGame() {
            localStorage.setItem('bsx_balance', balance);
            localStorage.setItem('bsx_inventory', JSON.stringify(inventory));
        }

        function loadGame() {
            const b = localStorage.getItem('bsx_balance');
            const i = localStorage.getItem('bsx_inventory');
            if (b) balance = parseInt(b);
            if (i) inventory = JSON.parse(i);
            updateBalance();
            updateInventory();
        }

        function showToast(msg) {
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.textContent = msg;
            document.body.appendChild(toast);
            setTimeout(() => toast.remove(), 2000);
        }

        function showWin(amount) {
            winAmount.textContent = amount + ' ‚≠ê';
            winModal.classList.add('active');
        }

        function updateBalance() {
            balanceEl.textContent = balance;
        }

        function updateInventory() {
            inventoryGrid.innerHTML = '';
            inventoryCount.textContent = inventory.length + '/20';
            
            for (let i = 0; i < Math.min(inventory.length, 20); i++) {
                const item = inventory[i];
                const slot = document.createElement('div');
                slot.className = 'inventory-slot';
                slot.innerHTML = `
                    <div class="slot-emoji">${item.emoji}</div>
                    <div class="slot-name">${item.name}</div>
                    <div class="slot-price">${item.price}‚≠ê</div>
                `;
                slot.onclick = () => sellItem(i);
                inventoryGrid.appendChild(slot);
            }
            
            for (let i = inventory.length; i < 20; i++) {
                const empty = document.createElement('div');
                empty.className = 'empty-slot';
                empty.textContent = '–ø—É—Å—Ç–æ';
                inventoryGrid.appendChild(empty);
            }
        }

        function sellItem(index) {
            const item = inventory[index];
            const price = Math.floor(item.price * 0.8);
            balance += price;
            inventory.splice(index, 1);
            updateBalance();
            updateInventory();
            saveGame();
            showToast(`‚úÖ –ü—Ä–æ–¥–∞–Ω–æ –∑–∞ ${price}‚≠ê`);
        }

        // –†–∞–∫–µ—Ç–∞
        function startFlight() {
            const bet = parseInt(betInput.value) || 100;
            
            if (bet > balance) {
                showToast('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–≤–µ–∑–¥!');
                return;
            }
            
            let timeLeft = 5;
            timerEl.textContent = timeLeft + '—Å';
            startBtn.disabled = true;
            
            countdownId = setInterval(() => {
                timeLeft--;
                timerEl.textContent = timeLeft + '—Å';
                
                if (timeLeft <= 0) {
                    clearInterval(countdownId);
                    executeFlight(bet);
                }
            }, 1000);
        }

        function executeFlight(bet) {
            balance -= bet;
            updateBalance();
            
            isFlying = true;
            multiplier = 1;
            
            startBtn.disabled = true;
            stopBtn.disabled = false;
            explosion.classList.remove('show');
            rocket.classList.remove('explode');
            
            if (intervalId) clearInterval(intervalId);
            
            intervalId = setInterval(() => {
                if (!isFlying) return;
                
                multiplier += 0.005 + Math.random() * 0.01;
                multiplierEl.textContent = multiplier.toFixed(2) + 'x';
                
                // –ß–∞—Å—Ç–æ –ø–∞–¥–∞–µ—Ç –Ω–∞ 1x - 1.2x
                if (Math.random() < 0.03) {
                    crashRocket(bet);
                }
                
                if (multiplier >= selectedAuto) {
                    stopFlight();
                }
            }, 100);
        }

        function crashRocket(bet) {
            clearInterval(intervalId);
            intervalId = null;
            
            isFlying = false;
            startBtn.disabled = false;
            stopBtn.disabled = true;
            
            explosion.classList.add('show');
            rocket.classList.add('explode');
            
            setTimeout(() => {
                explosion.classList.remove('show');
                rocket.classList.remove('explode');
            }, 1000);
            
            showToast(`üí• –í–∑—Ä—ã–≤! –ü—Ä–æ–∏–≥—Ä—ã—à: ${bet}‚≠ê`);
        }

        function stopFlight() {
            if (!isFlying) return;
            
            clearInterval(intervalId);
            intervalId = null;
            
            const bet = parseInt(betInput.value) || 100;
            const win = Math.floor(bet * multiplier);
            
            balance += win;
            updateBalance();
            saveGame();
            
            isFlying = false;
            startBtn.disabled = false;
            stopBtn.disabled = true;
            
            showWin(win);
        }

        // –ö–µ–π—Å—ã
        function renderCases() {
            casesGrid.innerHTML = '';
            CASES.forEach(c => {
                const card = document.createElement('div');
                card.className = 'case-card';
                card.innerHTML = `
                    <div class="case-emoji">${c.emoji}</div>
                    <div class="case-name">${c.name}</div>
                    <div class="case-price">${c.price} ‚≠ê</div>
                `;
                card.onclick = () => openCaseModal(c);
                casesGrid.appendChild(card);
            });
        }

        function openCaseModal(c) {
            currentCase = c;
            modalTitle.textContent = c.name;
            openCaseBtn.textContent = `–û–¢–ö–†–´–¢–¨ –ó–ê ${c.price} ‚≠ê`;
            
            // –°–æ–¥–µ—Ä–∂–∏–º–æ–µ
            modalContents.innerHTML = '';
            for (let i = 0; i < 8; i++) {
                const gift = GIFTS[Math.floor(Math.random() * GIFTS.length)];
                const chance = c.price <= 100 ? 
                    (Math.random() * 5 + 5).toFixed(1) : 
                    (Math.random() * 2 + 0.5).toFixed(1);
                
                const item = document.createElement('div');
                item.className = 'content-item';
                item.innerHTML = `
                    <div class="content-emoji">${gift.emoji}</div>
                    <div class="content-name">${gift.name}</div>
                    <div class="content-price">${gift.price}‚≠ê</div>
                `;
                modalContents.appendChild(item);
            }
            
            caseModal.classList.add('active');
        }

        function openCase() {
            if (!currentCase) return;
            
            const total = currentCase.price * selectedQty;
            
            if (balance < total) {
                showToast('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–≤–µ–∑–¥!');
                return;
            }
            
            balance -= total;
            
            let totalWin = 0;
            
            for (let i = 0; i < selectedQty; i++) {
                let maxPrice = currentCase.price <= 100 ? 
                    currentCase.price * 1.2 : 
                    currentCase.price * 0.3;
                
                const available = GIFTS.filter(g => g.price <= maxPrice);
                const gift = { ...available[Math.floor(Math.random() * available.length)] };
                gift.price = Math.floor(gift.price * (0.3 + Math.random() * 0.7));
                
                inventory.push(gift);
                totalWin += gift.price;
            }
            
            updateBalance();
            updateInventory();
            saveGame();
            
            caseModal.classList.remove('active');
            showWin(totalWin);
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        function init() {
            renderCases();
            loadGame();

            // –ê–≤—Ç–æ-–∫–Ω–æ–ø–∫–∏
            document.querySelectorAll('.auto-btn').forEach(btn => {
                btn.onclick = () => {
                    document.querySelectorAll('.auto-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    selectedAuto = parseFloat(btn.dataset.mult);
                };
            });

            // Quantity –∫–Ω–æ–ø–∫–∏
            document.querySelectorAll('.quantity-btn').forEach(btn => {
                btn.onclick = () => {
                    document.querySelectorAll('.quantity-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    selectedQty = parseInt(btn.dataset.qty);
                };
            });

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
            addBtn.onclick = () => {
                balance += 100;
                updateBalance();
                saveGame();
                showToast('+100‚≠ê –ø–æ–ª—É—á–µ–Ω–æ!');
            };

            startBtn.onclick = startFlight;
            stopBtn.onclick = stopFlight;
            
            closeModal.onclick = () => caseModal.classList.remove('active');
            openCaseBtn.onclick = openCase;
            
            closeWin.onclick = () => winModal.classList.remove('active');
        }

        init();
    </script>
</body>
</html>
