<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BOXSTARX FINAL üöÄ –ê–ë–°–û–õ–Æ–¢–ù–û–ï –°–û–í–ï–†–®–ï–ù–°–¢–í–û</title>
    <style>
        /* ========== –ü–ï–†–ï–ú–ï–ù–ù–´–ï –ò –°–ë–†–û–° ========== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* –ó–æ–ª–æ—Ç–∞—è –≥–∞–º–º–∞ */
            --gold-1: #fff9e6;
            --gold-2: #ffe48f;
            --gold-3: #ffd700;
            --gold-4: #ffaa33;
            --gold-5: #ff8c00;
            
            /* –§–æ–Ω—ã */
            --bg-deep: #0a0c1a;
            --bg-medium: #12172e;
            --bg-light: #1e2640;
            --glass-bg: rgba(20, 25, 45, 0.4);
            
            /* –°–∏—Å—Ç–µ–º–Ω—ã–µ */
            --success: #2e7d32;
            --success-light: #81c784;
            --error: #b71c1c;
            --error-light: #ef5350;
            
            /* –¢–µ–Ω–∏ */
            --shadow-sm: 0 10px 20px rgba(0, 0, 0, 0.6);
            --shadow-md: 0 20px 40px rgba(0, 0, 0, 0.8);
            --shadow-lg: 0 30px 60px rgba(0, 0, 0, 0.9);
            --glow-gold: 0 0 30px var(--gold-3);
            --glow-gold-intense: 0 0 60px var(--gold-3);
            
            /* –°–∫—Ä—É–≥–ª–µ–Ω–∏—è */
            --radius-sm: 16px;
            --radius-md: 24px;
            --radius-lg: 32px;
            --radius-xl: 48px;
            --radius-xxl: 64px;
        }

        body {
            overflow: hidden;
            background: #000;
            color: #fff;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            -webkit-font-smoothing: antialiased;
        }

        /* ========== –ò–î–ï–ê–õ–¨–ù–ê–Ø –ó–í–ï–ó–î–ù–ê–Ø –°–ò–°–¢–ï–ú–ê ========== */
        #starCanvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            background: radial-gradient(ellipse at 30% 40%, #0f142a 0%, #03051a 100%);
            display: block;
            pointer-events: none;
        }

        /* –¢—É–º–∞–Ω–Ω–æ—Å—Ç—å */
        .nebula {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: none;
            mix-blend-mode: overlay;
        }

        .nebula-1 {
            background: radial-gradient(circle at 20% 30%, rgba(150, 100, 255, 0.3) 0%, transparent 60%);
            animation: nebulaMove1 45s infinite alternate ease-in-out;
        }

        .nebula-2 {
            background: radial-gradient(circle at 80% 70%, rgba(100, 200, 255, 0.25) 0%, transparent 60%);
            animation: nebulaMove2 40s infinite alternate-reverse ease-in-out;
        }

        .nebula-3 {
            background: radial-gradient(circle at 40% 80%, rgba(255, 150, 200, 0.2) 0%, transparent 60%);
            animation: nebulaMove3 50s infinite alternate ease-in-out;
        }

        @keyframes nebulaMove1 {
            0% { transform: scale(1) translate(0, 0); opacity: 0.2; filter: hue-rotate(0deg); }
            100% { transform: scale(1.3) translate(-4%, 3%); opacity: 0.6; filter: hue-rotate(50deg); }
        }

        @keyframes nebulaMove2 {
            0% { transform: scale(1) translate(0, 0); opacity: 0.2; filter: hue-rotate(0deg); }
            100% { transform: scale(1.35) translate(5%, -3%); opacity: 0.55; filter: hue-rotate(-40deg); }
        }

        @keyframes nebulaMove3 {
            0% { transform: scale(1) translate(0, 0); opacity: 0.15; filter: hue-rotate(0deg); }
            100% { transform: scale(1.25) translate(-3%, -4%); opacity: 0.5; filter: hue-rotate(70deg); }
        }

        /* –ß–∞—Å—Ç–∏—Ü—ã */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 2;
            pointer-events: none;
            overflow: hidden;
        }

        .particle {
            position: absolute;
            width: 3px;
            height: 3px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 50%;
            box-shadow: 0 0 25px currentColor;
            animation: particleFly 35s infinite linear;
            will-change: transform, opacity;
        }

        @keyframes particleFly {
            0% { transform: translateY(100vh) translateX(0) scale(1); opacity: 0; }
            10% { opacity: 0.9; }
            90% { opacity: 0.9; }
            100% { transform: translateY(-300px) translateX(300px) scale(0.2); opacity: 0; }
        }

        /* ========== –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ô–ù–ï–† ========== */
        #app {
            position: relative;
            z-index: 10;
            width: 100vw;
            height: 100vh;
            overflow-y: auto;
            overflow-x: hidden;
            -webkit-overflow-scrolling: touch;
            backdrop-filter: blur(2px);
            scrollbar-width: none;
        }

        #app::-webkit-scrollbar {
            display: none;
        }

        .container {
            min-height: 100vh;
            padding: 20px;
            max-width: 500px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        /* ========== –ò–î–ï–ê–õ–¨–ù–´–ô –•–ï–î–ï–† ========== */
        .header {
            background: var(--glass-bg);
            backdrop-filter: blur(30px) saturate(200%);
            -webkit-backdrop-filter: blur(30px) saturate(200%);
            border: 1px solid rgba(255, 215, 0, 0.25);
            border-radius: var(--radius-xl);
            padding: 16px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow-md);
            position: relative;
            z-index: 100;
        }

        .balance-wrap {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .balance-icon {
            font-size: 2.4rem;
            filter: drop-shadow(0 0 25px var(--gold-3));
            animation: iconSpin 4s infinite ease-in-out;
        }

        @keyframes iconSpin {
            0%, 100% { transform: rotate(0deg) scale(1); }
            33% { transform: rotate(5deg) scale(1.1); }
            66% { transform: rotate(-5deg) scale(1.05); }
        }

        .balance-value {
            font-size: 2.2rem;
            font-weight: 800;
            background: linear-gradient(135deg, #fff, var(--gold-3), var(--gold-4));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 0 40px var(--gold-3);
        }

        .add-btn {
            background: linear-gradient(135deg, var(--success), #1b5e20);
            border: none;
            color: white;
            padding: 14px 30px;
            border-radius: var(--radius-xl);
            font-weight: 700;
            font-size: 1.1rem;
            cursor: pointer;
            border: 1px solid var(--success-light);
            box-shadow: 0 10px 20px rgba(46,125,50,0.4);
            transition: 0.2s;
            text-transform: uppercase;
            letter-spacing: 1.5px;
        }

        .add-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(46,125,50,0.7);
        }

        .add-btn:active {
            transform: translateY(0) scale(0.95);
        }

        /* ========== –ò–î–ï–ê–õ–¨–ù–ê–Ø –°–ò–°–¢–ï–ú–ê –°–ê–ú–û–õ–ï–¢–ê ========== */
        .flight-section {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border-radius: var(--radius-xxl);
            padding: 24px;
            border: 1px solid rgba(255, 215, 0, 0.25);
            box-shadow: var(--shadow-lg);
        }

        .flight-stage {
            position: relative;
            height: 240px;
            background: linear-gradient(180deg, #111c36 0%, #040c1c 100%);
            border-radius: var(--radius-lg);
            border: 2px solid var(--gold-3);
            overflow: hidden;
            margin-bottom: 20px;
            box-shadow: var(--glow-gold);
        }

        .runway-base {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 50px;
            background: linear-gradient(90deg, #222, #555, #222);
            border-top: 2px solid var(--gold-3);
        }

        .runway-stripes {
            position: absolute;
            bottom: 25px;
            left: 0;
            width: 100%;
            height: 2px;
            background: repeating-linear-gradient(90deg, var(--gold-3) 0px, var(--gold-3) 20px, transparent 20px, transparent 40px);
            animation: stripeMove 2s linear infinite;
            filter: drop-shadow(0 0 15px var(--gold-3));
        }

        @keyframes stripeMove {
            0% { transform: translateX(0); }
            100% { transform: translateX(-40px); }
        }

        .plane-model {
            position: absolute;
            left: -120px;
            top: 40%;
            transform: translateY(-50%);
            font-size: 6rem;
            filter: drop-shadow(0 0 50px var(--gold-3)) drop-shadow(0 0 100px var(--gold-4));
            transition: left 0.02s linear;
            z-index: 10;
            animation: planeBob 1s infinite alternate ease-in-out;
            will-change: left, transform;
        }

        @keyframes planeBob {
            0% { transform: translateY(-50%) translateY(0); }
            100% { transform: translateY(-50%) translateY(-15px); }
        }

        .plane-trail {
            position: absolute;
            height: 18px;
            background: linear-gradient(90deg, var(--gold-3), var(--gold-4), var(--gold-5), transparent);
            top: 40%;
            transform: translateY(-50%);
            right: 0;
            border-radius: 9px;
            opacity: 0.9;
            filter: blur(8px);
            transition: width 0.02s linear;
            box-shadow: 0 0 70px var(--gold-3);
            will-change: width;
        }

        .crash-animation {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 8rem;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
            z-index: 20;
            text-shadow: 0 0 100px #ff0000, 0 0 200px #ff6600;
            animation: crashShake 0.3s infinite;
        }

        @keyframes crashShake {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            25% { transform: translate(-50%, -50%) rotate(20deg); }
            75% { transform: translate(-50%, -50%) rotate(-20deg); }
        }

        /* –≠–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è */
        .control-group {
            display: flex;
            gap: 12px;
            margin-bottom: 15px;
        }

        .bet-input {
            flex: 1;
            background: rgba(10, 15, 30, 0.98);
            border: 2px solid var(--gold-3);
            color: var(--gold-3);
            padding: 18px;
            border-radius: var(--radius-xl);
            font-size: 1.2rem;
            font-weight: 600;
            text-align: center;
            outline: none;
            box-shadow: var(--glow-gold);
            transition: 0.2s;
        }

        .bet-input:focus {
            box-shadow: var(--glow-gold-intense);
            transform: scale(1.02);
            border-color: #fff;
        }

        .flight-button {
            flex: 1;
            padding: 18px;
            border: none;
            border-radius: var(--radius-xl);
            font-weight: 700;
            font-size: 1.2rem;
            cursor: pointer;
            transition: 0.2s;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .flight-button:active {
            transform: scale(0.95);
        }

        .btn-start {
            background: linear-gradient(135deg, #f9d423, #fdaa33, #ff8c00);
            box-shadow: 0 0 30px rgba(249,212,35,0.6);
        }

        .btn-stop {
            background: linear-gradient(135deg, #dc3545, #b02a37, #8b0000);
            color: white;
            box-shadow: 0 0 30px rgba(220,53,69,0.6);
        }

        .btn-stop:disabled {
            opacity: 0.3;
            cursor: not-allowed;
            box-shadow: none;
            pointer-events: none;
        }

        /* –ú–Ω–æ–∂–∏—Ç–µ–ª—å */
        .multiplier-panel {
            text-align: center;
            padding: 18px;
            background: rgba(0,0,0,0.7);
            backdrop-filter: blur(10px);
            border-radius: var(--radius-xl);
            border: 1px solid var(--gold-3);
            box-shadow: var(--glow-gold);
        }

        .multiplier-label {
            font-size: 1.1rem;
            color: #aaa;
            letter-spacing: 5px;
            text-transform: uppercase;
        }

        .multiplier-number {
            font-size: 3.5rem;
            font-weight: 900;
            background: linear-gradient(135deg, #ffd966, #ffaa33, #ff8c00);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-left: 15px;
            animation: pulseGlow 0.8s infinite alternate;
        }

        @keyframes pulseGlow {
            from { text-shadow: 0 0 30px var(--gold-3); }
            to { text-shadow: 0 0 80px var(--gold-3); }
        }

        /* ========== NFT-–ì–ê–õ–ï–†–ï–Ø ========== */
        .section-head {
            font-size: 2.2rem;
            font-weight: 800;
            text-align: center;
            margin: 30px 0 20px;
            background: linear-gradient(135deg, #fff, var(--gold-3), var(--gold-4), #ff6b6b);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-transform: uppercase;
            letter-spacing: 6px;
            animation: headPulse 3s infinite;
        }

        .section-head::before,
        .section-head::after {
            content: '‚ú¶';
            margin: 0 15px;
            opacity: 0.7;
            animation: starFlash 2s infinite;
            display: inline-block;
        }

        @keyframes headPulse {
            0% { text-shadow: 0 0 20px rgba(255,215,0,0.5); }
            50% { text-shadow: 0 0 70px rgba(255,215,0,0.9); }
        }

        @keyframes starFlash {
            0%, 100% { opacity: 0.5; transform: scale(1) rotate(0deg); }
            50% { opacity: 1; transform: scale(1.4) rotate(180deg); filter: drop-shadow(0 0 15px gold); }
        }

        .nft-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            margin-bottom: 30px;
            perspective: 2500px;
        }

        .nft-item {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border-radius: var(--radius-lg);
            padding: 18px 5px;
            text-align: center;
            border: 2px solid var(--gold-3);
            cursor: pointer;
            transition: 0.3s;
            transform-style: preserve-3d;
            box-shadow: var(--shadow-sm);
            position: relative;
            animation: cardFloat 4s infinite alternate;
        }

        @keyframes cardFloat {
            0% { transform: translateY(0) rotateX(0deg); }
            100% { transform: translateY(-15px) rotateX(6deg); }
        }

        .nft-item:hover {
            transform: translateY(-25px) rotateX(12deg) scale(1.12);
            box-shadow: var(--shadow-lg), 0 0 80px var(--gold-3);
            z-index: 100;
        }

        .nft-emoji {
            font-size: 3.5rem;
            margin-bottom: 8px;
            filter: drop-shadow(0 0 30px var(--gold-3));
            animation: emojiBeat 2s infinite;
        }

        @keyframes emojiBeat {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); filter: drop-shadow(0 0 50px var(--gold-3)); }
        }

        .nft-name {
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--gold-3);
            margin-bottom: 5px;
            text-transform: uppercase;
            letter-spacing: 1.5px;
        }

        .nft-cost {
            font-size: 0.9rem;
            background: rgba(0,0,0,0.7);
            padding: 5px 12px;
            border-radius: var(--radius-xl);
            display: inline-block;
            border: 1px solid var(--gold-3);
            font-weight: 600;
        }

        .nft-level {
            position: absolute;
            top: -12px;
            right: -12px;
            width: 34px;
            height: 34px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--gold-3), var(--gold-4));
            color: black;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            font-size: 1.1rem;
            border: 2px solid white;
            box-shadow: 0 0 30px var(--gold-3);
            animation: levelPulse 1s infinite;
        }

        @keyframes levelPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); box-shadow: 0 0 50px var(--gold-3); }
        }

        /* ========== –°–ò–°–¢–ï–ú–ê –ö–ï–ô–°–û–í ========== */
        .cases-layout {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .case-block {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border-radius: var(--radius-xxl);
            padding: 30px 15px;
            text-align: center;
            border: 3px solid var(--gold-3);
            cursor: pointer;
            transition: 0.3s;
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-md);
            animation: caseLevitate 5s infinite alternate;
        }

        @keyframes caseLevitate {
            0% { transform: translateY(0); }
            100% { transform: translateY(-20px); }
        }

        .case-block:hover {
            transform: translateY(-30px) scale(1.05);
            box-shadow: var(--shadow-lg), 0 0 100px var(--gold-3);
        }

        .case-block::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,215,0,0.3), transparent 70%);
            animation: spinGlow 15s linear infinite;
        }

        @keyframes spinGlow {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .case-emoji {
            font-size: 5.5rem;
            margin-bottom: 15px;
            filter: drop-shadow(0 0 50px var(--gold-3));
            animation: emojiFloat 2s infinite alternate;
        }

        @keyframes emojiFloat {
            0% { transform: translateY(0); }
            100% { transform: translateY(-15px); }
        }

        .case-title {
            font-size: 1.7rem;
            font-weight: 800;
            margin-bottom: 10px;
            color: var(--gold-3);
            text-transform: uppercase;
            letter-spacing: 2.5px;
        }

        .case-value {
            font-size: 2.4rem;
            font-weight: 900;
            background: linear-gradient(135deg, #ffd966, #ffaa33, #ff8c00);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        /* ========== –ò–ù–í–ï–ù–¢–ê–†–¨ ========== */
        .inventory-box {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border-radius: var(--radius-xxl);
            padding: 30px;
            border: 1px solid rgba(255, 215, 0, 0.25);
            box-shadow: var(--shadow-lg);
            margin-top: 20px;
        }

        .inventory-head {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .inventory-heading {
            font-size: 2.2rem;
            font-weight: 800;
            background: linear-gradient(135deg, #fff, var(--gold-3));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            letter-spacing: 2px;
        }

        .inventory-counter {
            background: rgba(0,0,0,0.7);
            padding: 10px 24px;
            border-radius: var(--radius-xl);
            color: var(--gold-3);
            font-size: 1.3rem;
            font-weight: 600;
            border: 1px solid var(--gold-3);
            box-shadow: var(--glow-gold);
        }

        .inventory-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
        }

        .inventory-cell {
            background: rgba(10, 15, 25, 0.98);
            border: 2px solid var(--gold-3);
            border-radius: var(--radius-lg);
            padding: 15px 5px;
            text-align: center;
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: 0.2s;
            box-shadow: var(--shadow-sm);
        }

        .inventory-cell:hover {
            transform: scale(1.1);
            box-shadow: 0 0 70px var(--gold-3);
            border-color: #fff;
        }

        .inventory-cell:active {
            transform: scale(0.95);
        }

        .cell-emoji {
            font-size: 2.8rem;
            margin-bottom: 6px;
            filter: drop-shadow(0 0 20px var(--gold-3));
        }

        .cell-name {
            font-size: 0.75rem;
            color: var(--gold-3);
            font-weight: 600;
            text-transform: uppercase;
            margin-bottom: 3px;
        }

        .cell-price {
            font-size: 0.7rem;
            background: rgba(0,0,0,0.7);
            padding: 3px 10px;
            border-radius: var(--radius-xl);
            border: 1px solid var(--gold-3);
        }

        .cell-empty {
            background: rgba(10, 15, 25, 0.5);
            border: 2px dashed var(--gold-3);
            border-radius: var(--radius-lg);
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1.5px;
        }

        /* ========== –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û ========== */
        .modal-window {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0, 0, 0, 0.98);
            backdrop-filter: blur(70px);
            -webkit-backdrop-filter: blur(70px);
            z-index: 2000;
            display: none;
            flex-direction: column;
            padding: 30px 20px;
            overflow-y: auto;
            animation: modalAppear 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes modalAppear {
            from { opacity: 0; transform: scale(0.7) translateY(70px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }

        .modal-window.active {
            display: flex;
        }

        .modal-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
        }

        .modal-close {
            background: rgba(255,255,255,0.1);
            border: 2px solid var(--gold-3);
            color: white;
            width: 70px;
            height: 70px;
            border-radius: 50%;
            font-size: 2.4rem;
            cursor: pointer;
            transition: 0.3s;
            box-shadow: 0 0 25px rgba(255,215,0,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-close:hover {
            background: var(--gold-3);
            color: black;
            transform: scale(1.2) rotate(90deg);
            box-shadow: 0 0 60px var(--gold-3);
        }

        .modal-heading {
            font-size: 3rem;
            font-weight: 900;
            background: linear-gradient(135deg, #fff, var(--gold-3), var(--gold-4));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            letter-spacing: 4px;
        }

        .modal-preview {
            background: rgba(30, 35, 55, 0.7);
            backdrop-filter: blur(25px);
            border-radius: var(--radius-xxl);
            padding: 60px;
            text-align: center;
            margin-bottom: 40px;
            border: 3px solid var(--gold-3);
            box-shadow: 0 0 150px var(--gold-3);
            animation: previewGlow 3s infinite;
        }

        @keyframes previewGlow {
            0% { box-shadow: 0 0 70px var(--gold-3); }
            50% { box-shadow: 0 0 170px var(--gold-3); }
        }

        .modal-case-emoji {
            font-size: 12rem;
            filter: drop-shadow(0 0 80px var(--gold-3));
            animation: modalEmojiFloat 2s infinite alternate;
        }

        @keyframes modalEmojiFloat {
            0% { transform: translateY(0) scale(1); }
            100% { transform: translateY(-35px) scale(1.1); }
        }

        .modal-case-title {
            font-size: 3.5rem;
            font-weight: 900;
            color: var(--gold-3);
            margin: 20px 0 10px;
            text-transform: uppercase;
        }

        .modal-case-cost {
            font-size: 3rem;
            color: var(--gold-3);
            font-weight: 700;
        }

        .prizes-label {
            font-size: 2.4rem;
            color: var(--gold-3);
            text-align: center;
            margin-bottom: 30px;
            letter-spacing: 5px;
            text-transform: uppercase;
        }

        .prizes-layout {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 40px;
        }

        .prize-tile {
            background: rgba(30, 35, 55, 0.7);
            backdrop-filter: blur(15px);
            border-radius: var(--radius-xl);
            padding: 35px 15px;
            text-align: center;
            border: 2px solid var(--gold-3);
            transition: 0.3s;
            animation: tileFloat 3s infinite alternate;
        }

        @keyframes tileFloat {
            0% { transform: translateY(0); }
            100% { transform: translateY(-20px); }
        }

        .prize-tile:hover {
            transform: scale(1.15) translateY(-20px);
            box-shadow: 0 0 80px var(--gold-3);
            z-index: 100;
        }

        .prize-emoji {
            font-size: 5rem;
            margin-bottom: 15px;
            filter: drop-shadow(0 0 30px var(--gold-3));
        }

        .prize-name {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--gold-3);
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        .prize-rarity {
            font-size: 1.2rem;
            background: rgba(0,0,0,0.7);
            padding: 6px 20px;
            border-radius: var(--radius-xl);
            display: inline-block;
            border: 1px solid var(--gold-3);
        }

        .open-case-button {
            background: linear-gradient(135deg, #f9d423, #fdaa33, #ff8c00);
            border: none;
            padding: 35px;
            border-radius: var(--radius-xxl);
            font-size: 3rem;
            font-weight: 900;
            cursor: pointer;
            margin: 25px 0;
            border: 3px solid var(--gold-3);
            box-shadow: 0 0 120px var(--gold-3);
            text-transform: uppercase;
            letter-spacing: 8px;
            transition: 0.3s;
            animation: buttonPulse 2s infinite;
            color: #1a1e2b;
        }

        @keyframes buttonPulse {
            0% { transform: scale(1); box-shadow: 0 0 80px var(--gold-3); }
            50% { transform: scale(1.05); box-shadow: 0 0 180px var(--gold-3); }
        }

        .open-case-button:active {
            transform: scale(0.95);
        }

        .tap-hint {
            text-align: center;
            color: #aaa;
            font-size: 1.2rem;
            animation: hintPulse 2s infinite;
            text-transform: uppercase;
            letter-spacing: 3px;
        }

        @keyframes hintPulse {
            0% { opacity: 0.5; }
            50% { opacity: 1; text-shadow: 0 0 30px var(--gold-3); }
        }

        /* ========== –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø ========== */
        .toast {
            position: fixed;
            top: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, var(--success), #1b5e20);
            color: white;
            padding: 20px 50px;
            border-radius: var(--radius-xxl);
            font-weight: 700;
            font-size: 1.3rem;
            z-index: 3000;
            border: 2px solid var(--gold-3);
            box-shadow: 0 20px 60px black;
            animation: toastIn 0.3s;
            text-transform: uppercase;
            letter-spacing: 3px;
        }

        .toast.error {
            background: linear-gradient(135deg, var(--error), #8b0000);
        }

        @keyframes toastIn {
            from { top: -50px; opacity: 0; transform: translateX(-50%) scale(0.7); }
            to { top: 30px; opacity: 1; transform: translateX(-50%) scale(1); }
        }
    </style>
</head>
<body>
    <!-- –ó–≤–µ–∑–¥–Ω—ã–π —Ñ–æ–Ω -->
    <canvas id="starCanvas"></canvas>
    <div class="nebula nebula-1"></div>
    <div class="nebula nebula-2"></div>
    <div class="nebula nebula-3"></div>
    <div class="particles" id="particleField"></div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ -->
    <div id="app">
        <div class="container">
            <!-- –•–µ–¥–µ—Ä -->
            <header class="header">
                <div class="balance-wrap">
                    <span class="balance-icon">‚≠ê</span>
                    <span class="balance-value" id="balanceDisplay">5000</span>
                </div>
                <button class="add-btn" id="addMoneyBtn">+100</button>
            </header>

            <!-- –°–∞–º–æ–ª–µ—Ç -->
            <section class="flight-section">
                <div class="flight-stage" id="flightStage">
                    <div class="runway-base"></div>
                    <div class="runway-stripes"></div>
                    <div class="plane-model" id="planeElement">‚úàÔ∏è</div>
                    <div class="plane-trail" id="trailElement" style="width: 0px;"></div>
                    <div class="crash-animation" id="crashElement">üí•</div>
                </div>
                
                <div class="control-group">
                    <input type="number" class="bet-input" id="betField" min="10" value="149" step="10" placeholder="–°—Ç–∞–≤–∫–∞">
                    <button class="flight-button btn-start" id="startFlightBtn">üöÄ –°–¢–ê–†–¢</button>
                    <button class="flight-button btn-stop" id="stopFlightBtn" disabled>‚èπÔ∏è –°–¢–û–ü</button>
                </div>
                
                <div class="multiplier-panel">
                    <span class="multiplier-label">–ú–ù–û–ñ–ò–¢–ï–õ–¨</span>
                    <span class="multiplier-number" id="multiplierDisplay">1.00x</span>
                </div>
            </section>

            <!-- NFT –≥–∞–ª–µ—Ä–µ—è -->
            <h2 class="section-head">NFT –ì–ê–õ–ï–†–ï–Ø</h2>
            <div class="nft-grid" id="nftContainer"></div>

            <!-- –ö–µ–π—Å—ã -->
            <h2 class="section-head">–ö–ï–ô–°–´</h2>
            <div class="cases-layout" id="casesContainer"></div>

            <!-- –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å -->
            <section class="inventory-box">
                <div class="inventory-head">
                    <span class="inventory-heading">–ò–ù–í–ï–ù–¢–ê–†–¨</span>
                    <span class="inventory-counter" id="inventoryCounter">0/24</span>
                </div>
                <div class="inventory-grid" id="inventoryContainer"></div>
            </section>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ -->
    <div class="modal-window" id="caseModal">
        <div class="modal-bar">
            <button class="modal-close" id="closeModalBtn">‚Üê</button>
            <div class="modal-heading" id="modalTitle">–ö–ï–ô–°</div>
            <div style="width: 70px;"></div>
        </div>
        
        <div class="modal-preview">
            <div class="modal-case-emoji" id="modalIcon">üì¶</div>
            <div class="modal-case-title" id="modalCaseTitle">–ù–ê–ó–í–ê–ù–ò–ï</div>
            <div class="modal-case-cost" id="modalCaseCost">‚òÖ 0</div>
        </div>
        
        <h3 class="prizes-label">–í–û–ó–ú–û–ñ–ù–´–ï –ü–†–ò–ó–´</h3>
        <div class="prizes-layout" id="modalPrizesContainer"></div>
        
        <button class="open-case-button" id="openCaseModalBtn">–û–¢–ö–†–´–¢–¨ –ó–ê ‚òÖ 0</button>
        <div class="tap-hint">üëÜ –î–í–û–ô–ù–û–ô –¢–ê–ü –î–õ–Ø –ë–´–°–¢–†–û–ì–û –û–¢–ö–†–´–¢–ò–Ø</div>
    </div>

    <script>
        (function() {
            'use strict';

            // ========== –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø ==========
            const CONFIG = {
                STAR_COUNT: 3000,
                SHOOTING_STAR_COUNT: 60,
                INVENTORY_SIZE: 24,
                INITIAL_BALANCE: 5000,
                MIN_BET: 10,
                FLIGHT_SPEED: 2.2,
                CRASH_BASE_CHANCE: 0.007,
                WIN_CHANCE: 0.3
            };

            // ========== –î–ê–ù–ù–´–ï ==========
            const NFT_GIFTS = [
                { emoji: "üéÇ", name: "–¢–û–†–¢", price: 15, rarity: 1 },
                { emoji: "‚ù§Ô∏è", name: "–°–ï–†–î–¶–ï", price: 25, rarity: 1 },
                { emoji: "üî•", name: "–û–ì–û–ù–¨", price: 50, rarity: 1 },
                { emoji: "üéÅ", name: "–ü–û–î–ê–†–û–ö", price: 50, rarity: 1 },
                { emoji: "üéâ", name: "–ü–†–ê–ó–î–ù–ò–ö", price: 100, rarity: 1 },
                { emoji: "üíé", name: "–ê–õ–ú–ê–ó", price: 100, rarity: 1 },
                { emoji: "üëë", name: "–ö–û–†–û–ù–ê", price: 150, rarity: 2 },
                { emoji: "üöÄ", name: "–†–ê–ö–ï–¢–ê", price: 150, rarity: 2 },
                { emoji: "‚≠ê", name: "–ó–í–ï–ó–î–ê", price: 250, rarity: 2 },
                { emoji: "üåü", name: "–°–£–ü–ï–†–ó–í–ï–ó–î–ê", price: 300, rarity: 2 },
                { emoji: "üí´", name: "–ö–û–ú–ï–¢–ê", price: 500, rarity: 3 },
                { emoji: "‚ö°", name: "–ú–û–õ–ù–ò–Ø", price: 500, rarity: 3 },
                { emoji: "üéà", name: "–®–ê–†", price: 750, rarity: 3 },
                { emoji: "üéä", name: "–ö–û–ù–§–ï–¢–¢–ò", price: 1000, rarity: 3 },
                { emoji: "‚ú®", name: "–ë–õ–ï–°–¢–ö–ò", price: 1500, rarity: 4 },
                { emoji: "ü¶Ñ", name: "–ï–î–ò–ù–û–†–û–ì", price: 2500, rarity: 4 },
                { emoji: "üåà", name: "–†–ê–î–£–ì–ê", price: 3000, rarity: 4 },
                { emoji: "üå†", name: "–ú–ï–¢–ï–û–†", price: 5000, rarity: 5 },
                { emoji: "‚òÑÔ∏è", name: "–ê–°–¢–ï–†–û–ò–î", price: 7500, rarity: 5 },
                { emoji: "üõ∏", name: "–ù–õ–û", price: 10000, rarity: 5 }
            ];

            const CASES = [
                { name: "PLAYER", icon: "üéÆ", price: 149, gifts: [0,1,2,3,4,5] },
                { name: "BEAR", icon: "üêª", price: 199, gifts: [1,2,3,4,5,6] },
                { name: "LAMP", icon: "üí°", price: 249, gifts: [2,3,4,5,6,7] },
                { name: "SKULL", icon: "üíÄ", price: 499, gifts: [3,4,5,6,7,8] },
                { name: "NEKO", icon: "üê±", price: 999, gifts: [4,5,6,7,8,9] },
                { name: "BRICK", icon: "üß±", price: 1499, gifts: [5,6,7,8,9,10] },
                { name: "DRAGON", icon: "üêâ", price: 2499, gifts: [6,7,8,9,10,11] },
                { name: "PHOENIX", icon: "üî•", price: 3999, gifts: [7,8,9,10,11,12] }
            ];

            // ========== –°–û–°–¢–û–Ø–ù–ò–ï ==========
            const state = {
                balance: CONFIG.INITIAL_BALANCE,
                inventory: [],
                currentCase: null,
                isFlying: false,
                multiplier: 1,
                intervalId: null,
                planePos: -120
            };

            // ========== DOM –≠–õ–ï–ú–ï–ù–¢–´ ==========
            const elements = {
                balance: document.getElementById('balanceDisplay'),
                addMoney: document.getElementById('addMoneyBtn'),
                startBtn: document.getElementById('startFlightBtn'),
                stopBtn: document.getElementById('stopFlightBtn'),
                betField: document.getElementById('betField'),
                multiplier: document.getElementById('multiplierDisplay'),
                plane: document.getElementById('planeElement'),
                trail: document.getElementById('trailElement'),
                crash: document.getElementById('crashElement'),
                nftContainer: document.getElementById('nftContainer'),
                casesContainer: document.getElementById('casesContainer'),
                inventoryContainer: document.getElementById('inventoryContainer'),
                inventoryCounter: document.getElementById('inventoryCounter'),
                modal: document.getElementById('caseModal'),
                closeModal: document.getElementById('closeModalBtn'),
                modalTitle: document.getElementById('modalTitle'),
                modalIcon: document.getElementById('modalIcon'),
                modalCaseTitle: document.getElementById('modalCaseTitle'),
                modalCaseCost: document.getElementById('modalCaseCost'),
                modalPrizes: document.getElementById('modalPrizesContainer'),
                openModalBtn: document.getElementById('openCaseModalBtn')
            };

            // ========== –ó–í–ï–ó–î–ù–ê–Ø –°–ò–°–¢–ï–ú–ê ==========
            const canvas = document.getElementById('starCanvas');
            if (!canvas) throw new Error('Canvas not found');
            
            const ctx = canvas.getContext('2d');
            let width = window.innerWidth;
            let height = window.innerHeight;
            let stars = [];
            let shootingStars = [];

            function initStars() {
                stars = [];
                for (let i = 0; i < CONFIG.STAR_COUNT; i++) {
                    stars.push({
                        x: Math.random() * width,
                        y: Math.random() * height,
                        radius: Math.random() * 5 + 1,
                        speed: Math.random() * 0.2 + 0.02,
                        brightness: Math.random() * 0.5 + 0.2,
                        flicker: Math.random() * 0.02 + 0.001,
                        hue: Math.random() * 360
                    });
                }

                shootingStars = [];
                for (let i = 0; i < CONFIG.SHOOTING_STAR_COUNT; i++) {
                    shootingStars.push({
                        x: Math.random() * width,
                        y: Math.random() * height * 0.3,
                        length: Math.random() * 700 + 350,
                        speed: Math.random() * 35 + 30,
                        angle: Math.random() * 0.5 + 0.25,
                        hue: Math.random() * 360,
                        tail: []
                    });
                }
            }

            function resizeCanvas() {
                width = window.innerWidth;
                height = window.innerHeight;
                canvas.width = width;
                canvas.height = height;
                initStars();
            }

            function drawStars() {
                ctx.clearRect(0, 0, width, height);
                
                // –ì–ª—É–±–æ–∫–∏–π –∫–æ—Å–º–æ—Å
                const gradient = ctx.createRadialGradient(width/2, height/2, 0, width/2, height/2, width);
                gradient.addColorStop(0, '#0f142a');
                gradient.addColorStop(0.3, '#090d22');
                gradient.addColorStop(0.6, '#04071a');
                gradient.addColorStop(1, '#000000');
                ctx.fillStyle = gradient;
                ctx.fillRect(0, 0, width, height);
                
                // –ó–≤–µ–∑–¥—ã
                ctx.shadowBlur = 25;
                for (let i = 0; i < stars.length; i++) {
                    const s = stars[i];
                    s.y += s.speed * 0.02;
                    if (s.y > height) {
                        s.y = 0;
                        s.x = Math.random() * width;
                    }
                    s.brightness += s.flicker;
                    if (s.brightness > 1 || s.brightness < 0.3) s.flicker *= -1;
                    s.hue = (s.hue + 0.05) % 360;
                    
                    ctx.globalAlpha = s.brightness * 0.8;
                    ctx.fillStyle = `hsl(${s.hue}, 100%, 75%)`;
                    ctx.shadowColor = `hsl(${s.hue}, 100%, 65%)`;
                    ctx.beginPath();
                    ctx.arc(s.x, s.y, s.radius, 0, Math.PI * 2);
                    ctx.fill();
                }

                // –ü–∞–¥–∞—é—â–∏–µ –∑–≤–µ–∑–¥—ã
                ctx.shadowBlur = 80;
                for (let i = 0; i < shootingStars.length; i++) {
                    const ss = shootingStars[i];
                    ss.x += ss.speed * Math.cos(ss.angle);
                    ss.y += ss.speed * Math.sin(ss.angle);
                    
                    ss.tail.push({ x: ss.x, y: ss.y });
                    if (ss.tail.length > 35) ss.tail.shift();
                    
                    if (ss.y > height + 200 || ss.x > width + 200) {
                        ss.x = Math.random() * width * 0.3;
                        ss.y = Math.random() * height * 0.2;
                        ss.tail = [];
                    }
                    
                    ss.hue = (ss.hue + 10) % 360;
                    
                    for (let j = 0; j < ss.tail.length; j++) {
                        const p = ss.tail[j];
                        const alpha = (j / ss.tail.length) * 0.8;
                        const size = 6 + (j / ss.tail.length) * 12;
                        
                        ctx.globalAlpha = alpha;
                        ctx.fillStyle = `hsl(${ss.hue}, 100%, 80%)`;
                        ctx.shadowColor = `hsl(${ss.hue}, 100%, 70%)`;
                        ctx.beginPath();
                        ctx.arc(p.x, p.y, size * 0.8, 0, Math.PI * 2);
                        ctx.fill();
                    }
                    
                    ctx.globalAlpha = 1;
                    ctx.fillStyle = `hsl(${ss.hue}, 100%, 95%)`;
                    ctx.shadowColor = `hsl(${ss.hue}, 100%, 80%)`;
                    ctx.beginPath();
                    ctx.arc(ss.x, ss.y, 18, 0, Math.PI * 2);
                    ctx.fill();
                }
                
                ctx.shadowBlur = 0;
                requestAnimationFrame(drawStars);
            }

            // ========== –ß–ê–°–¢–ò–¶–´ ==========
            function initParticles() {
                const field = document.getElementById('particleField');
                if (!field) return;
                field.innerHTML = '';
                for (let i = 0; i < 120; i++) {
                    const p = document.createElement('div');
                    p.className = 'particle';
                    p.style.left = Math.random() * 100 + '%';
                    p.style.animationDelay = Math.random() * 30 + 's';
                    p.style.animationDuration = (Math.random() * 25 + 30) + 's';
                    p.style.background = `hsl(${Math.random() * 360}, 100%, 75%)`;
                    field.appendChild(p);
                }
            }

            // ========== –°–û–•–†–ê–ù–ï–ù–ò–ï ==========
            function saveGame() {
                try {
                    localStorage.setItem('bsx_final_balance', state.balance);
                    localStorage.setItem('bsx_final_inventory', JSON.stringify(state.inventory));
                } catch (e) {
                    console.warn('Save error:', e);
                }
            }

            function loadGame() {
                try {
                    const savedBalance = localStorage.getItem('bsx_final_balance');
                    const savedInventory = localStorage.getItem('bsx_final_inventory');
                    if (savedBalance) state.balance = parseInt(savedBalance) || CONFIG.INITIAL_BALANCE;
                    if (savedInventory) state.inventory = JSON.parse(savedInventory) || [];
                } catch (e) {
                    console.warn('Load error:', e);
                }
                updateUI();
            }

            // ========== –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø ==========
            function showToast(msg, isSuccess = true) {
                const toast = document.createElement('div');
                toast.className = `toast ${!isSuccess ? 'error' : ''}`;
                toast.textContent = msg;
                document.body.appendChild(toast);
                setTimeout(() => toast.remove(), 2500);
            }

            // ========== –û–ë–ù–û–í–õ–ï–ù–ò–ï UI ==========
            function updateUI() {
                if (elements.balance) elements.balance.textContent = state.balance;
                updateInventory();
            }

            function updateInventory() {
                if (!elements.inventoryContainer || !elements.inventoryCounter) return;
                
                elements.inventoryContainer.innerHTML = '';
                elements.inventoryCounter.textContent = `${state.inventory.length}/${CONFIG.INVENTORY_SIZE}`;
                
                for (let i = 0; i < Math.min(state.inventory.length, CONFIG.INVENTORY_SIZE); i++) {
                    const item = state.inventory[i];
                    const slot = document.createElement('div');
                    slot.className = 'inventory-cell';
                    slot.innerHTML = `
                        <div class="cell-emoji">${item.emoji}</div>
                        <div class="cell-name">${item.name}</div>
                        <div class="cell-price">${item.price}‚≠ê</div>
                    `;
                    slot.addEventListener('click', () => sellItem(i));
                    elements.inventoryContainer.appendChild(slot);
                }
                
                for (let i = state.inventory.length; i < CONFIG.INVENTORY_SIZE; i++) {
                    const empty = document.createElement('div');
                    empty.className = 'cell-empty';
                    empty.textContent = '–ø—É—Å—Ç–æ';
                    elements.inventoryContainer.appendChild(empty);
                }
            }

            function sellItem(index) {
                if (index >= state.inventory.length) return;
                const item = state.inventory[index];
                const price = Math.floor(item.price * 0.8);
                state.balance += price;
                state.inventory.splice(index, 1);
                updateUI();
                saveGame();
                showToast(`‚úÖ ${item.name} –ø—Ä–æ–¥–∞–Ω –∑–∞ ${price}‚≠ê`);
            }

            // ========== –°–ê–ú–û–õ–ï–¢ ==========
            function startFlight() {
                const bet = parseInt(elements.betField?.value) || 149;
                
                if (bet > state.balance) {
                    showToast('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–≤–µ–∑–¥!', false);
                    return;
                }
                
                if (bet < CONFIG.MIN_BET) {
                    showToast(`‚ùå –ú–∏–Ω. —Å—Ç–∞–≤–∫–∞ ${CONFIG.MIN_BET}‚≠ê`, false);
                    return;
                }
                
                state.balance -= bet;
                updateUI();
                saveGame();
                
                state.isFlying = true;
                state.multiplier = 1;
                state.planePos = -120;
                if (elements.startBtn) elements.startBtn.disabled = true;
                if (elements.stopBtn) elements.stopBtn.disabled = false;
                if (elements.crash) elements.crash.style.opacity = '0';
                if (elements.multiplier) elements.multiplier.textContent = '1.00x';
                
                if (state.intervalId) clearInterval(state.intervalId);
                
                state.intervalId = setInterval(() => {
                    if (!state.isFlying) return;
                    
                    state.planePos += CONFIG.FLIGHT_SPEED;
                    if (elements.plane) elements.plane.style.left = state.planePos + 'px';
                    if (elements.trail) elements.trail.style.width = (state.planePos + 140) + 'px';
                    
                    state.multiplier += 0.022 + Math.random() * 0.025;
                    if (elements.multiplier) elements.multiplier.textContent = state.multiplier.toFixed(2) + 'x';
                    
                    const crashChance = CONFIG.CRASH_BASE_CHANCE + (state.multiplier - 1) * 0.006;
                    if (Math.random() < crashChance) {
                        crashPlane(bet);
                    }
                    
                    if (state.planePos > 600) {
                        crashPlane(bet);
                    }
                }, 30);
            }

            function crashPlane(bet) {
                if (state.intervalId) {
                    clearInterval(state.intervalId);
                    state.intervalId = null;
                }
                
                state.isFlying = false;
                if (elements.startBtn) elements.startBtn.disabled = false;
                if (elements.stopBtn) elements.stopBtn.disabled = true;
                if (elements.crash) elements.crash.style.opacity = '1';
                if (elements.multiplier) elements.multiplier.textContent = 'üí• –ü–ê–î–ï–ù–ò–ï';
                
                setTimeout(() => {
                    state.planePos = -120;
                    if (elements.plane) elements.plane.style.left = '-120px';
                    if (elements.trail) elements.trail.style.width = '0px';
                    if (elements.crash) elements.crash.style.opacity = '0';
                    if (elements.multiplier) elements.multiplier.textContent = '1.00x';
                }, 1000);
                
                showToast(`üí• –ü—Ä–æ–∏–≥—Ä—ã—à: ${bet}‚≠ê`, false);
            }

            function stopFlight() {
                if (!state.isFlying) return;
                
                if (state.intervalId) {
                    clearInterval(state.intervalId);
                    state.intervalId = null;
                }
                
                const bet = parseInt(elements.betField?.value) || 149;
                const win = Math.floor(bet * state.multiplier);
                
                state.balance += win;
                updateUI();
                saveGame();
                
                state.isFlying = false;
                if (elements.startBtn) elements.startBtn.disabled = false;
                if (elements.stopBtn) elements.stopBtn.disabled = true;
                
                state.planePos = -120;
                if (elements.plane) elements.plane.style.left = '-120px';
                if (elements.trail) elements.trail.style.width = '0px';
                if (elements.multiplier) elements.multiplier.textContent = '1.00x';
                
                showToast(`‚ú® –í—ã–∏–≥—Ä—ã—à: ${win}‚≠ê (x${state.multiplier.toFixed(2)})`);
            }

            // ========== –ö–ï–ô–°–´ ==========
            function openCaseModal(caseData) {
                state.currentCase = caseData;
                if (elements.modalTitle) elements.modalTitle.textContent = caseData.name;
                if (elements.modalIcon) elements.modalIcon.textContent = caseData.icon;
                if (elements.modalCaseTitle) elements.modalCaseTitle.textContent = caseData.name;
                if (elements.modalCaseCost) elements.modalCaseCost.textContent = `‚òÖ ${caseData.price}`;
                if (elements.openModalBtn) elements.openModalBtn.textContent = `–û–¢–ö–†–´–¢–¨ –ó–ê ‚òÖ ${caseData.price}`;
                
                if (elements.modalPrizes) {
                    elements.modalPrizes.innerHTML = '';
                    caseData.gifts.forEach(idx => {
                        const gift = NFT_GIFTS[idx];
                        const prize = document.createElement('div');
                        prize.className = 'prize-tile';
                        prize.innerHTML = `
                            <div class="prize-emoji">${gift.emoji}</div>
                            <div class="prize-name">${gift.name}</div>
                            <div class="prize-rarity">${gift.rarity}‚òÖ</div>
                        `;
                        elements.modalPrizes.appendChild(prize);
                    });
                }
                
                if (elements.modal) elements.modal.classList.add('active');
            }

            function openCase() {
                if (!state.currentCase) return;
                
                if (state.balance < state.currentCase.price) {
                    showToast('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–≤–µ–∑–¥!', false);
                    return;
                }
                
                state.balance -= state.currentCase.price;
                
                if (Math.random() < CONFIG.WIN_CHANCE) {
                    const mult = 1.5 + Math.random() * 0.5;
                    const idx = state.currentCase.gifts[Math.floor(Math.random() * state.currentCase.gifts.length)];
                    const gift = { ...NFT_GIFTS[idx] };
                    gift.price = Math.floor(gift.price * mult);
                    state.inventory.push(gift);
                    showToast(`üéâ –í–´–ò–ì–†–´–® x${mult.toFixed(2)}! ${gift.name}`);
                } else {
                    if (Math.random() < 0.5) {
                        const stars = Math.floor(state.currentCase.price * 0.3);
                        state.balance += stars;
                        showToast(`‚≠ê –£—Ç–µ—à–µ–Ω–∏–µ: ${stars} –∑–≤–µ–∑–¥`);
                    } else {
                        const idx = state.currentCase.gifts[0];
                        const gift = { ...NFT_GIFTS[idx] };
                        gift.price = Math.floor(gift.price * 0.3);
                        state.inventory.push(gift);
                        showToast(`üì¶ –£—Ç–µ—à–µ–Ω–∏–µ: ${gift.name}`);
                    }
                }
                
                updateUI();
                saveGame();
            }

            // ========== –†–ï–ù–î–ï–†–ò–ù–ì ==========
            function renderNFTs() {
                if (!elements.nftContainer) return;
                elements.nftContainer.innerHTML = '';
                NFT_GIFTS.slice(0, 16).forEach(g => {
                    const card = document.createElement('div');
                    card.className = 'nft-item';
                    card.innerHTML = `
                        <div class="nft-emoji">${g.emoji}</div>
                        <div class="nft-name">${g.name}</div>
                        <div class="nft-cost">${g.price}‚≠ê</div>
                        <div class="nft-level">${g.rarity}</div>
                    `;
                    card.addEventListener('click', () => {
                        if (state.balance >= g.price) {
                            state.balance -= g.price;
                            state.inventory.push(g);
                            updateUI();
                            saveGame();
                            showToast(`üéÅ –ö—É–ø–ª–µ–Ω: ${g.name}`);
                        } else {
                            showToast('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–≤–µ–∑–¥!', false);
                        }
                    });
                    elements.nftContainer.appendChild(card);
                });
            }

            function renderCases() {
                if (!elements.casesContainer) return;
                elements.casesContainer.innerHTML = '';
                CASES.forEach(c => {
                    const card = document.createElement('div');
                    card.className = 'case-block';
                    card.innerHTML = `
                        <div class="case-emoji">${c.icon}</div>
                        <div class="case-title">${c.name}</div>
                        <div class="case-value">‚òÖ ${c.price}</div>
                    `;
                    card.addEventListener('click', () => openCaseModal(c));
                    elements.casesContainer.appendChild(card);
                });
            }

            // ========== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ==========
            function initEventListeners() {
                if (elements.addMoney) {
                    elements.addMoney.addEventListener('click', () => {
                        state.balance += 100;
                        updateUI();
                        saveGame();
                        showToast('+100‚≠ê –ø–æ–ª—É—á–µ–Ω–æ!');
                    });
                }

                if (elements.startBtn) elements.startBtn.addEventListener('click', startFlight);
                if (elements.stopBtn) elements.stopBtn.addEventListener('click', stopFlight);
                
                if (elements.closeModal) {
                    elements.closeModal.addEventListener('click', () => {
                        if (elements.modal) elements.modal.classList.remove('active');
                    });
                }
                
                if (elements.openModalBtn) elements.openModalBtn.addEventListener('click', openCase);
                
                if (elements.modal) {
                    elements.modal.addEventListener('click', (e) => {
                        if (e.target === elements.modal) {
                            elements.modal.classList.remove('active');
                        }
                    });
                }
            }

            function init() {
                resizeCanvas();
                initStars();
                drawStars();
                initParticles();
                initEventListeners();
                renderNFTs();
                renderCases();
                loadGame();
                
                window.addEventListener('resize', () => {
                    resizeCanvas();
                    initStars();
                });
            }

            // –°—Ç–∞—Ä—Ç
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', init);
            } else {
                init();
            }
        })();
    </script>
</body>
</html>
