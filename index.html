<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BoxStarX 3D üöÄ –•–ê–†–î–ö–û–†</title>
    <style>
        /* ========== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –°–¢–ò–õ–ò ========== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Inter', system-ui, sans-serif;
        }

        body {
            overflow-x: hidden;
            color: white;
            background: #03050a;
        }

        /* 3D –ö–∞–Ω–≤–∞—Å –¥–ª—è —Å–∞–º–æ–ª–µ—Ç–∞ */
        #planeCanvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: none;
        }

        /* –ó–≤–µ–∑–¥–Ω—ã–π —Ñ–æ–Ω */
        #starCanvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            background: radial-gradient(ellipse at 30% 40%, #0b1120 0%, #03050f 100%);
            display: block;
            pointer-events: none;
        }

        /* –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–∞—è –Ω–∞–¥–ø–∏—Å—å */
        .splash-title {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: clamp(3rem, 15vw, 6rem);
            font-weight: 900;
            z-index: 2000;
            background: linear-gradient(135deg, #fff6d5, #ffd966, #ffaa33, #ff6b6b);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 0 50px rgba(255, 215, 0, 0.8), 0 0 100px rgba(255, 100, 0, 0.5);
            letter-spacing: 10px;
            animation: epicFadeOut 2.5s cubic-bezier(0.4, 0, 0.2, 1) forwards;
            white-space: nowrap;
            pointer-events: none;
        }

        @keyframes epicFadeOut {
            0% { opacity: 1; transform: translate(-50%, -50%) scale(1.2); filter: blur(0); }
            30% { opacity: 1; transform: translate(-50%, -50%) scale(1); filter: blur(0); }
            70% { opacity: 0.5; transform: translate(-50%, -50%) scale(0.8); filter: blur(5px); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(0.3); filter: blur(15px); visibility: hidden; }
        }

        /* –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç */
        .content {
            position: relative;
            z-index: 10;
            min-height: 100vh;
            padding: 20px 20px 40px;
            backdrop-filter: blur(2px);
            max-width: 1600px;
            margin: 0 auto;
        }

        /* ========== –£–õ–£–ß–®–ï–ù–ù–´–ô HUD ========== */
        .hud {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 24px;
            background: rgba(5, 10, 20, 0.7);
            backdrop-filter: blur(16px) saturate(180%);
            -webkit-backdrop-filter: blur(16px) saturate(180%);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 60px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.8), 0 0 0 1px rgba(255, 215, 0, 0.1) inset;
            flex-wrap: wrap;
            gap: 15px;
        }

        .balance-block {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .balance {
            background: linear-gradient(145deg, #1e2638, #0f1625);
            padding: 12px 28px;
            border-radius: 50px;
            font-size: 1.4rem;
            font-weight: 700;
            border: 1px solid #ffd966;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .balance::before {
            content: "‚≠ê";
            font-size: 1.6rem;
            filter: drop-shadow(0 0 10px gold);
        }

        .add-balance {
            background: linear-gradient(135deg, #2e7d32, #1b5e20);
            border: none;
            color: white;
            padding: 12px 25px;
            border-radius: 50px;
            font-weight: bold;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid #81c784;
            box-shadow: 0 5px 15px rgba(46, 125, 50, 0.4);
        }

        .add-balance:hover {
            transform: translateY(-3px);
            filter: brightness(1.2);
            box-shadow: 0 15px 25px rgba(46, 125, 50, 0.6);
        }

        .bet-panel {
            display: flex;
            align-items: center;
            gap: 15px;
            background: rgba(0, 0, 0, 0.4);
            padding: 8px 20px;
            border-radius: 50px;
            border: 1px solid rgba(255, 215, 0, 0.3);
        }

        .bet-panel label {
            color: #aaa;
            font-size: 0.95rem;
        }

        .bet-panel input {
            background: rgba(0, 0, 0, 0.6);
            border: 1px solid #ffd966;
            color: #ffd966;
            padding: 10px 16px;
            border-radius: 40px;
            width: 100px;
            font-weight: bold;
            font-size: 1.1rem;
            text-align: center;
            outline: none;
        }

        .bet-panel input:focus {
            border-color: white;
            box-shadow: 0 0 20px gold;
        }

        .flight-controls {
            display: flex;
            gap: 12px;
        }

        .btn {
            padding: 14px 32px;
            border: none;
            border-radius: 50px;
            font-weight: 700;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.2s;
            text-transform: uppercase;
            letter-spacing: 1px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .btn-start {
            background: linear-gradient(135deg, #f9d423, #fdaa33);
            color: #1a1e2b;
            box-shadow: 0 10px 20px rgba(249, 212, 35, 0.3);
        }

        .btn-start:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 20px 30px rgba(249, 212, 35, 0.5);
        }

        .btn-stop {
            background: linear-gradient(135deg, #dc3545, #b02a37);
            color: white;
            box-shadow: 0 10px 20px rgba(220, 53, 69, 0.3);
        }

        .btn-stop:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 20px 30px rgba(220, 53, 69, 0.5);
        }

        .btn-stop:disabled, .btn-start:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª–µ—Ç–µ */
        .flight-info {
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid gold;
            border-radius: 60px;
            padding: 15px 30px;
            margin: 20px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 1.3rem;
            font-weight: bold;
        }

        .multiplier {
            color: #ffd966;
            text-shadow: 0 0 20px gold;
            font-size: 2rem;
        }

        /* ========== –ö–ï–ô–°–´ ========== */
        .section-title {
            font-size: 2.2rem;
            font-weight: 800;
            text-align: center;
            margin: 50px 0 30px;
            background: linear-gradient(135deg, #fff, #ffd966, #ffaa33);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-transform: uppercase;
            letter-spacing: 4px;
            text-shadow: 0 0 30px rgba(255,215,0,0.3);
        }

        .cases-battle {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }

        .battle-case {
            background: linear-gradient(145deg, #1e2842, #0e162a);
            border-radius: 30px;
            padding: 20px 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 3px solid transparent;
            border-image: linear-gradient(135deg, gold, #ff6b6b, #aaffaa);
            border-image-slice: 1;
            box-shadow: 0 30px 40px -20px black, 0 0 0 2px rgba(255,215,0,0.3) inset;
            position: relative;
        }

        .battle-case:hover {
            transform: translateY(-10px);
            box-shadow: 0 40px 60px -10px black, 0 0 50px gold;
        }

        .case-rarity {
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, gold, #ffaa33);
            color: black;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.8rem;
            text-transform: uppercase;
        }

        .case-icon {
            font-size: 3.5rem;
            margin: 15px 0 10px;
            filter: drop-shadow(0 0 20px gold);
        }

        .case-name {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .case-price {
            font-size: 1.8rem;
            font-weight: 900;
            background: linear-gradient(135deg, #ffd966, #ffaa33);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .case-chance {
            color: #ff6b6b;
            font-size: 0.8rem;
            margin-top: 10px;
            font-weight: bold;
        }

        /* ========== TELEGRAM –ü–û–î–ê–†–ö–ò ========== */
        .gifts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .gift-item {
            background: linear-gradient(145deg, #2a2f45, #1a1f30);
            border-radius: 20px;
            padding: 20px 10px;
            text-align: center;
            border: 2px solid gold;
            transition: all 0.3s;
            cursor: pointer;
            position: relative;
        }

        .gift-item:hover {
            transform: scale(1.05);
            border-color: #ffaa33;
            box-shadow: 0 0 30px gold;
        }

        .gift-emoji {
            font-size: 3rem;
            filter: drop-shadow(0 0 15px currentColor);
            margin-bottom: 10px;
        }

        .gift-name {
            font-weight: bold;
            margin: 5px 0;
            color: gold;
        }

        .gift-price {
            background: rgba(0,0,0,0.5);
            padding: 5px;
            border-radius: 20px;
            font-size: 0.9rem;
        }

        /* ========== –°–ò–°–¢–ï–ú–ê –ê–ü–ì–†–ï–ô–î–ê ========== */
        .upgrade-section {
            background: rgba(10, 15, 30, 0.7);
            backdrop-filter: blur(10px);
            border-radius: 40px;
            padding: 30px;
            margin: 40px 0;
            border: 1px solid gold;
        }

        .upgrade-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .upgrade-card {
            background: linear-gradient(145deg, #1e2638, #0f1625);
            border-radius: 30px;
            padding: 25px 20px;
            border: 2px solid transparent;
            background-image: linear-gradient(#1e2638, #0f1625), 
                            linear-gradient(135deg, gold, #ff6b6b, #4a90e2);
            background-origin: border-box;
            background-clip: padding-box, border-box;
            cursor: pointer;
            transition: all 0.3s;
        }

        .upgrade-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.6);
        }

        .upgrade-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .upgrade-icon {
            font-size: 2.5rem;
        }

        .upgrade-info {
            flex: 1;
        }

        .upgrade-name {
            font-weight: bold;
            font-size: 1.2rem;
            color: gold;
        }

        .upgrade-level {
            color: #aaa;
            font-size: 0.9rem;
        }

        .upgrade-stats {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            color: #ddd;
        }

        .upgrade-price {
            background: linear-gradient(135deg, gold, #ffaa33);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            font-weight: bold;
            font-size: 1.3rem;
        }

        .upgrade-btn {
            background: linear-gradient(135deg, #4a90e2, #357abd);
            border: none;
            color: white;
            padding: 12px;
            border-radius: 30px;
            width: 100%;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid gold;
        }

        .upgrade-btn:hover {
            filter: brightness(1.1);
            transform: scale(1.02);
        }

        .upgrade-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* ========== –£–í–ï–õ–ò–ß–ï–ù–ù–´–ô –ò–ù–í–ï–ù–¢–ê–†–¨ ========== */
        .inventory-section {
            background: rgba(10, 15, 30, 0.7);
            backdrop-filter: blur(10px);
            border-radius: 40px;
            padding: 30px;
            margin: 40px 0;
            border: 1px solid gold;
            width: 100%;
            overflow-x: auto;
        }

        .inventory-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .inventory-stats {
            background: rgba(0,0,0,0.3);
            padding: 8px 20px;
            border-radius: 30px;
            color: gold;
            font-size: 1.1rem;
        }

        .inventory-grid {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 15px;
            min-width: min(100%, 1200px);
        }

        .inventory-slot {
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid #ffd966;
            border-radius: 20px;
            padding: 15px 5px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            transition: all 0.2s;
            cursor: pointer;
            position: relative;
            aspect-ratio: 1 / 1;
            min-width: 90px;
        }

        .inventory-slot:hover {
            transform: scale(1.05);
            border-color: white;
            box-shadow: 0 0 20px gold;
            z-index: 10;
        }

        .slot-emoji {
            font-size: 2.2rem;
        }

        .slot-name {
            font-size: 0.7rem;
            text-align: center;
            word-break: break-word;
        }

        .slot-level {
            position: absolute;
            top: -5px;
            right: -5px;
            background: linear-gradient(135deg, gold, #ffaa33);
            color: black;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.8rem;
            border: 1px solid white;
        }

        .empty-slot {
            background: rgba(255, 255, 255, 0.05);
            border: 2px dashed #555;
            border-radius: 20px;
            aspect-ratio: 1 / 1;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #555;
            min-width: 90px;
        }

        /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
        .notification {
            position: fixed;
            top: 100px;
            left: 50%;
            transform: translateX(-50%);
            padding: 15px 30px;
            border-radius: 50px;
            font-weight: bold;
            z-index: 10000;
            animation: slideIn 0.3s ease;
            box-shadow: 0 10px 30px black;
            border: 1px solid gold;
        }

        @keyframes slideIn {
            from { top: 50px; opacity: 0; }
            to { top: 100px; opacity: 1; }
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 1200px) {
            .inventory-grid {
                grid-template-columns: repeat(6, 1fr);
            }
        }

        @media (max-width: 800px) {
            .inventory-grid {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .hud {
                flex-direction: column;
                border-radius: 30px;
            }
        }
    </style>
</head>
<body>
    <!-- 3D –ö–∞–Ω–≤–∞—Å –¥–ª—è —Å–∞–º–æ–ª–µ—Ç–∞ -->
    <canvas id="planeCanvas"></canvas>
    
    <!-- –ó–≤–µ–∑–¥–Ω—ã–π —Ñ–æ–Ω -->
    <canvas id="starCanvas"></canvas>

    <!-- –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–∞—è –Ω–∞–¥–ø–∏—Å—å -->
    <div class="splash-title">BOXSTARX HARDCORE üöÄ</div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <div class="content">
        <!-- HUD –ø–∞–Ω–µ–ª—å -->
        <div class="hud">
            <div class="balance-block">
                <div class="balance">
                    <span id="balance">5000</span>
                </div>
                <button class="add-balance" id="addBalance">‚ûï +100</button>
            </div>

            <div class="bet-panel">
                <label>üí∞ –°–¢–ê–í–ö–ê</label>
                <input type="number" id="betAmount" min="10" value="100" step="10">
            </div>

            <div class="flight-controls">
                <button class="btn btn-start" id="startFlight">üöÄ –í–ó–õ–ï–¢</button>
                <button class="btn btn-stop" id="stopFlight" disabled>‚èπÔ∏è –°–¢–û–ü</button>
            </div>
        </div>

        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª–µ—Ç–µ -->
        <div class="flight-info">
            <span>üöÄ –°–¢–ê–¢–£–° –ü–û–õ–ï–¢–ê:</span>
            <span class="multiplier" id="flightStatus">–û–ñ–ò–î–ê–ù–ò–ï</span>
        </div>

        <!-- –ö–µ–π—Å—ã —Å –Ω–∏–∑–∫–∏–º–∏ —à–∞–Ω—Å–∞–º–∏ -->
        <h2 class="section-title">‚ö° –•–ê–†–î–ö–û–† –ö–ï–ô–°–´ ‚ö°</h2>
        <div class="cases-battle" id="casesContainer"></div>

        <!-- Telegram –ø–æ–¥–∞—Ä–∫–∏ -->
        <h2 class="section-title">üéÅ TELEGRAM –ü–û–î–ê–†–ö–ò</h2>
        <div class="gifts-grid" id="giftsContainer"></div>

        <!-- –°–∏—Å—Ç–µ–º–∞ –∞–ø–≥—Ä–µ–π–¥–∞ -->
        <div class="upgrade-section">
            <h2 class="section-title">‚ö° –ü–†–û–ö–ê–ß–ö–ê</h2>
            <div class="upgrade-grid" id="upgradesContainer"></div>
        </div>

        <!-- –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å (20 —Å–ª–æ—Ç–æ–≤) -->
        <div class="inventory-section">
            <div class="inventory-header">
                <h2 class="section-title" style="margin:0;">üì¶ –ò–ù–í–ï–ù–¢–ê–†–¨ (20 —Å–ª–æ—Ç–æ–≤)</h2>
                <div class="inventory-stats" id="inventoryStats">–ü—Ä–µ–¥–º–µ—Ç–æ–≤: 0/20</div>
            </div>
            <div class="inventory-grid" id="inventoryGrid"></div>
        </div>
    </div>

    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º Three.js –¥–ª—è 3D -->
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.128.0/build/three.module.js"
            }
        }
    </script>

    <script type="module">
        // ==================== 1. –¢–†–ï–•–ú–ï–†–ù–´–ô –°–ê–ú–û–õ–ï–¢ ====================
        import * as THREE from 'three';

        const canvas = document.getElementById('planeCanvas');
        const scene = new THREE.Scene();
        scene.background = null;
        
        const camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(0, 2, 10);
        camera.lookAt(0, 0, 0);
        
        const renderer = new THREE.WebGLRenderer({ canvas, alpha: true, antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.shadowMap.enabled = true;

        // –û—Å–≤–µ—â–µ–Ω–∏–µ
        const ambientLight = new THREE.AmbientLight(0x404060);
        scene.add(ambientLight);
        
        const dirLight = new THREE.DirectionalLight(0xffeedd, 1);
        dirLight.position.set(1, 3, 2);
        dirLight.castShadow = true;
        scene.add(dirLight);

        // –°–æ–∑–¥–∞–Ω–∏–µ —Å–∞–º–æ–ª–µ—Ç–∞
        const planeGroup = new THREE.Group();

        // –ö–æ—Ä–ø—É—Å
        const bodyGeo = new THREE.CylinderGeometry(0.5, 0.5, 2, 8);
        const bodyMat = new THREE.MeshStandardMaterial({ color: 0x3a6ea5, metalness: 0.7, roughness: 0.3 });
        const body = new THREE.Mesh(bodyGeo, bodyMat);
        body.rotation.x = Math.PI / 2;
        body.castShadow = true;
        planeGroup.add(body);

        // –ö—Ä—ã–ª—å—è
        const wingGeo = new THREE.BoxGeometry(2, 0.1, 0.8);
        const wingMat = new THREE.MeshStandardMaterial({ color: 0x2a5a8c });
        const wings = new THREE.Mesh(wingGeo, wingMat);
        wings.position.y = 0;
        wings.castShadow = true;
        planeGroup.add(wings);

        // –¢—É—Ä–±–∏–Ω—ã
        const turbineGeo = new THREE.CylinderGeometry(0.3, 0.3, 0.4, 8);
        const turbineMat = new THREE.MeshStandardMaterial({ color: 0xcccccc, emissive: 0x4466aa });
        
        const turbine1 = new THREE.Mesh(turbineGeo, turbineMat);
        turbine1.position.set(0.6, -0.2, -0.8);
        turbine1.rotation.x = Math.PI / 2;
        planeGroup.add(turbine1);
        
        const turbine2 = new THREE.Mesh(turbineGeo, turbineMat);
        turbine2.position.set(-0.6, -0.2, -0.8);
        turbine2.rotation.x = Math.PI / 2;
        planeGroup.add(turbine2);

        scene.add(planeGroup);
        planeGroup.scale.set(0.8, 0.8, 0.8);

        // ==================== 2. –ó–í–ï–ó–î–ù–´–ô –§–û–ù ====================
        const starCanvas = document.getElementById('starCanvas');
        const ctx = starCanvas.getContext('2d');
        let width, height;
        let stars2D = [];
        const STAR_COUNT = 400;

        function initStars2D() {
            stars2D = [];
            for (let i = 0; i < STAR_COUNT; i++) {
                stars2D.push({
                    x: Math.random() * width,
                    y: Math.random() * height,
                    radius: Math.random() * 2.5 + 0.5,
                    speed: Math.random() * 0.4 + 0.1,
                    brightness: Math.random() * 0.5 + 0.3,
                    flickerSpeed: Math.random() * 0.02 + 0.005,
                    color: `hsl(${Math.random() * 60 + 30}, 80%, 70%)`
                });
            }
        }

        function resizeCanvas() {
            width = window.innerWidth;
            height = window.innerHeight;
            starCanvas.width = width;
            starCanvas.height = height;
            initStars2D();
            
            camera.aspect = width / height;
            camera.updateProjectionMatrix();
            renderer.setSize(width, height);
        }

        function drawStars2D() {
            ctx.clearRect(0, 0, width, height);
            
            stars2D.forEach(star => {
                star.y += star.speed * 0.15;
                if (star.y > height) {
                    star.y = 0;
                    star.x = Math.random() * width;
                }
                
                star.brightness += star.flickerSpeed;
                if (star.brightness > 1 || star.brightness < 0.3) star.flickerSpeed *= -1;
                
                ctx.globalAlpha = star.brightness;
                ctx.fillStyle = star.color;
                ctx.beginPath();
                ctx.arc(star.x, star.y, star.radius, 0, Math.PI * 2);
                ctx.fill();
            });
        }

        // ==================== 3. –î–ê–ù–ù–´–ï –ò–ì–†–´ ====================
        let balance = 5000;
        let isFlying = false;
        let currentMultiplier = 1;
        let planeInterval = null;
        
        // –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å (20 —Å–ª–æ—Ç–æ–≤)
        let inventory = [];
        const MAX_INVENTORY = 20;
        
        // –£—Ä–æ–≤–Ω–∏ –∞–ø–≥—Ä–µ–π–¥–∞
        let upgrades = {
            luck: { level: 1, value: 1, price: 500 },
            multiplier: { level: 1, value: 1, price: 800 },
            protection: { level: 1, value: 1, price: 600 },
            giftChance: { level: 1, value: 1, price: 1000 }
        };

        // Telegram –ø–æ–¥–∞—Ä–∫–∏
        const TELEGRAM_GIFTS = [
            { id: 'star', emoji: '‚≠ê', name: '–ó–≤–µ–∑–¥–∞', basePrice: 50 },
            { id: 'heart', emoji: '‚ù§Ô∏è', name: '–°–µ—Ä–¥—Ü–µ', basePrice: 75 },
            { id: 'fire', emoji: 'üî•', name: '–û–≥–æ–Ω—å', basePrice: 100 },
            { id: 'diamond', emoji: 'üíé', name: '–ê–ª–º–∞–∑', basePrice: 200 },
            { id: 'crown', emoji: 'üëë', name: '–ö–æ—Ä–æ–Ω–∞', basePrice: 500 },
            { id: 'rocket', emoji: 'üöÄ', name: '–†–∞–∫–µ—Ç–∞', basePrice: 750 },
            { id: 'trophy', emoji: 'üèÜ', name: '–¢—Ä–æ—Ñ–µ–π', basePrice: 1000 },
            { id: 'alien', emoji: 'üëæ', name: '–ò–Ω–æ–ø–ª–∞–Ω–µ—Ç—è–Ω–∏–Ω', basePrice: 1500 }
        ];

        // –ö–µ–π—Å—ã —Å –æ—á–µ–Ω—å –Ω–∏–∑–∫–∏–º–∏ —à–∞–Ω—Å–∞–º–∏ –Ω–∞ –≤—ã–∏–≥—Ä—ã—à (90% –ø—Ä–æ–∏–≥—Ä—ã—à)
        const CASES = [
            { 
                id: 'common', name: '–û–±—ã—á–Ω—ã–π', icon: 'üì¶', price: 100,
                items: [
                    { emoji: '‚≠ê', name: '–ó–≤–µ–∑–¥–∞', chance: 6, level: 1 },
                    { emoji: '‚ù§Ô∏è', name: '–°–µ—Ä–¥—Ü–µ', chance: 3, level: 1 },
                    { emoji: 'üî•', name: '–û–≥–æ–Ω—å', chance: 1, level: 1 }
                ],
                loseChance: 90 // 90% –ø—Ä–æ–∏–≥—Ä—ã—à
            },
            { 
                id: 'rare', name: '–†–µ–¥–∫–∏–π', icon: '‚ú®', price: 300,
                items: [
                    { emoji: 'üî•', name: '–û–≥–æ–Ω—å', chance: 4, level: 1 },
                    { emoji: 'üíé', name: '–ê–ª–º–∞–∑', chance: 3, level: 1 },
                    { emoji: 'üëë', name: '–ö–æ—Ä–æ–Ω–∞', chance: 2, level: 1 },
                    { emoji: 'üöÄ', name: '–†–∞–∫–µ—Ç–∞', chance: 1, level: 1 }
                ],
                loseChance: 90
            },
            { 
                id: 'epic', name: '–≠–ø–∏—á–µ—Å–∫–∏–π', icon: 'üåü', price: 600,
                items: [
                    { emoji: 'üíé', name: '–ê–ª–º–∞–∑', chance: 4, level: 1 },
                    { emoji: 'üëë', name: '–ö–æ—Ä–æ–Ω–∞', chance: 3, level: 1 },
                    { emoji: 'üöÄ', name: '–†–∞–∫–µ—Ç–∞', chance: 2, level: 1 },
                    { emoji: 'üèÜ', name: '–¢—Ä–æ—Ñ–µ–π', chance: 1, level: 1 }
                ],
                loseChance: 90
            },
            { 
                id: 'legendary', name: '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π', icon: 'üëë', price: 1000,
                items: [
                    { emoji: 'üöÄ', name: '–†–∞–∫–µ—Ç–∞', chance: 4, level: 1 },
                    { emoji: 'üèÜ', name: '–¢—Ä–æ—Ñ–µ–π', chance: 3, level: 1 },
                    { emoji: 'üëæ', name: '–ò–Ω–æ–ø–ª–∞–Ω–µ—Ç—è–Ω–∏–Ω', chance: 2, level: 1 },
                    { emoji: 'üí´', name: '–ö–æ–º–µ—Ç–∞', chance: 1, level: 2 }
                ],
                loseChance: 90
            },
            { 
                id: 'mythic', name: '–ú–∏—Ñ–∏—á–µ—Å–∫–∏–π', icon: '‚ö°', price: 2000,
                items: [
                    { emoji: 'üèÜ', name: '–¢—Ä–æ—Ñ–µ–π', chance: 4, level: 2 },
                    { emoji: 'üëæ', name: '–ò–Ω–æ–ø–ª–∞–Ω–µ—Ç—è–Ω–∏–Ω', chance: 3, level: 2 },
                    { emoji: 'üí´', name: '–ö–æ–º–µ—Ç–∞', chance: 2, level: 2 },
                    { emoji: 'üå†', name: '–ú–µ—Ç–µ–æ—Ä', chance: 1, level: 3 }
                ],
                loseChance: 90
            }
        ];

        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const balanceEl = document.getElementById('balance');
        const betInput = document.getElementById('betAmount');
        const startBtn = document.getElementById('startFlight');
        const stopBtn = document.getElementById('stopFlight');
        const addBalanceBtn = document.getElementById('addBalance');
        const flightStatus = document.getElementById('flightStatus');
        const inventoryGrid = document.getElementById('inventoryGrid');
        const inventoryStats = document.getElementById('inventoryStats');

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
        function updateBalanceUI() {
            balanceEl.textContent = balance;
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        function showNotification(message, type = 'info') {
            const notif = document.createElement('div');
            notif.className = 'notification';
            notif.style.background = type === 'success' ? 'linear-gradient(135deg, #2e7d32, #1b5e20)' : 
                                   type === 'error' ? 'linear-gradient(135deg, #b71c1c, #8b0000)' : 
                                   'linear-gradient(135deg, #1976d2, #0d47a1)';
            notif.textContent = message;
            document.body.appendChild(notif);
            
            setTimeout(() => notif.remove(), 2000);
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–∞ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
        function addToInventory(item) {
            if (inventory.length >= MAX_INVENTORY) {
                showNotification('‚ùå –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø–æ–ª–æ–Ω! –ü—Ä–æ–¥–∞–π—Ç–µ —á—Ç–æ-–Ω–∏–±—É–¥—å', 'error');
                return false;
            }
            inventory.push(item);
            updateInventoryUI();
            showNotification(`üéÅ –ü–æ–ª—É—á–µ–Ω: ${item.name}`, 'success');
            return true;
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
        function updateInventoryUI() {
            inventoryGrid.innerHTML = '';
            inventoryStats.textContent = `–ü—Ä–µ–¥–º–µ—Ç–æ–≤: ${inventory.length}/${MAX_INVENT
